<UserControl x:Class="BrowserSelector.Pages.DocsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:controls="clr-namespace:BrowserSelector.Controls"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="800"
             Background="#FAFAFA">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/LinkRouter;component/Themes/Windows11Theme.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        </ResourceDictionary>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <StackPanel Margin="24,32,40,32" MaxWidth="800">

            <!-- Page Title -->
            <TextBlock Text="Documentation"
                       Style="{StaticResource Title3TextStyle}"
                       Margin="0,0,0,16"/>

            <!-- Getting Started Section -->
            <TextBlock Text="Getting Started"
                       Style="{StaticResource SectionHeaderStyle}"/>

            <!-- Set as Default Browser -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="DefaultBrowserExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#F3F3F3" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="1" FontWeight="Bold" FontSize="16" Foreground="#0078D4" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Set as Default Browser" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="How to configure LinkRouter as your default browser handler" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=DefaultBrowserExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=DefaultBrowserExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                <Run FontWeight="SemiBold">Step 1:</Run> Go to Settings > App Registration and click "Register"
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                <Run FontWeight="SemiBold">Step 2:</Run> Open Windows Settings > Apps > Default apps
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                <Run FontWeight="SemiBold">Step 3:</Run> Search for "LinkRouter" or "BrowserSelector"
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap">
                                <Run FontWeight="SemiBold">Step 4:</Run> Set it as the default for HTTP and HTTPS protocols
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Creating URL Rules -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="CreateRulesExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#F3F3F3" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="2" FontWeight="Bold" FontSize="16" Foreground="#0078D4" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Creating URL Rules" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="How to create rules for specific URLs" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=CreateRulesExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=CreateRulesExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                URL rules allow you to automatically open specific URLs in a designated browser and profile.
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                <Run FontWeight="SemiBold">To create a rule:</Run>
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">1. Go to Manage Rules</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">2. Click "+ Add" and select "URL Rule"</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">3. Enter a URL pattern (e.g., github.com)</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,0">4. Select a browser and profile, then save</TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Using URL Groups -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="UrlGroupsExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#F3F3F3" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="3" FontWeight="Bold" FontSize="16" Foreground="#0078D4" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Using URL Groups" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="Organize multiple URLs with similar rules" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=UrlGroupsExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=UrlGroupsExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                URL Groups let you manage multiple URL patterns together, all using the same browser and profile settings.
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                <Run FontWeight="SemiBold">Built-in groups</Run> include Microsoft 365 and Google Suite URLs.
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap">
                                You can enable/disable groups with the toggle switch, or create your own custom groups.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- URL PATTERN SYNTAX Section -->
            <TextBlock Text="URL Pattern Syntax"
                       Style="{StaticResource SectionHeaderStyle}"/>

            <Border Style="{StaticResource SettingsCardStyle}" Padding="20">
                <StackPanel>
                    <TextBlock Text="LinkRouter supports flexible URL pattern matching:"
                               Style="{StaticResource BodyTextStyle}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16"/>

                    <!-- Pattern Examples -->
                    <Border Background="#F3F3F3" CornerRadius="4" Padding="16" Margin="0,0,0,12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="8"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="8"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="8"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="8"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Pattern" FontWeight="SemiBold" Style="{StaticResource CaptionStrongTextStyle}"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="Matches" FontWeight="SemiBold" Style="{StaticResource CaptionStrongTextStyle}"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="github.com" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="All GitHub URLs" Style="{StaticResource CaptionTextStyle}"/>

                            <TextBlock Grid.Row="4" Grid.Column="0" Text="localhost" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                            <TextBlock Grid.Row="4" Grid.Column="1" Text="All localhost URLs (any port)" Style="{StaticResource CaptionTextStyle}"/>

                            <TextBlock Grid.Row="6" Grid.Column="0" Text="*.sharepoint.com" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                            <TextBlock Grid.Row="6" Grid.Column="1" Text="All SharePoint subdomains" Style="{StaticResource CaptionTextStyle}"/>

                            <TextBlock Grid.Row="8" Grid.Column="0" Text="outlook.office.com" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                            <TextBlock Grid.Row="8" Grid.Column="1" Text="Exact domain match" Style="{StaticResource CaptionTextStyle}"/>
                        </Grid>
                    </Border>

                    <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap">
                        <Run FontWeight="SemiBold">Tip:</Run> Use wildcards (*) to match multiple subdomains. Patterns are matched against the hostname portion of URLs.
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- PRIORITY ORDER Section -->
            <TextBlock Text="Rule Priority"
                       Style="{StaticResource SectionHeaderStyle}"/>

            <Border Style="{StaticResource SettingsCardStyle}" Padding="20">
                <StackPanel>
                    <TextBlock Text="Rules are matched in the following order:"
                               Style="{StaticResource BodyTextStyle}"
                               Margin="0,0,0,12"/>

                    <StackPanel Margin="8,0,0,0">
                        <TextBlock Style="{StaticResource BodyTextStyle}" Margin="0,0,0,6">
                            <Run FontWeight="SemiBold" Foreground="#0078D4">1.</Run>
                            <Run FontWeight="SemiBold">URL Group Overrides</Run>
                            <Run Foreground="#5D5D5D">- Specific URL overrides within groups</Run>
                        </TextBlock>
                        <TextBlock Style="{StaticResource BodyTextStyle}" Margin="0,0,0,6">
                            <Run FontWeight="SemiBold" Foreground="#0078D4">2.</Run>
                            <Run FontWeight="SemiBold">URL Groups</Run>
                            <Run Foreground="#5D5D5D">- Enabled groups (auto-open)</Run>
                        </TextBlock>
                        <TextBlock Style="{StaticResource BodyTextStyle}" Margin="0,0,0,6">
                            <Run FontWeight="SemiBold" Foreground="#0078D4">3.</Run>
                            <Run FontWeight="SemiBold">Individual Rules</Run>
                            <Run Foreground="#5D5D5D">- Single URL pattern rules</Run>
                        </TextBlock>
                        <TextBlock Style="{StaticResource BodyTextStyle}">
                            <Run FontWeight="SemiBold" Foreground="#0078D4">4.</Run>
                            <Run FontWeight="SemiBold">Default Browser</Run>
                            <Run Foreground="#5D5D5D">- Used when no rules match</Run>
                        </TextBlock>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- BROWSER & PROFILE MANAGEMENT Section -->
            <TextBlock Text="Browser &amp; Profile Management"
                       Style="{StaticResource SectionHeaderStyle}"/>

            <!-- Supported Browsers -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="SupportedBrowsersExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#E8F5E9" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="ðŸŒ" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Supported Browsers" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="Browsers that LinkRouter can detect and route to" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=SupportedBrowsersExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=SupportedBrowsersExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,12">
                                LinkRouter automatically detects and supports the following browsers:
                            </TextBlock>
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Style="{StaticResource BodyTextStyle}" Margin="0,0,0,4">â€¢ Google Chrome</TextBlock>
                                    <TextBlock Style="{StaticResource BodyTextStyle}" Margin="0,0,0,4">â€¢ Microsoft Edge</TextBlock>
                                    <TextBlock Style="{StaticResource BodyTextStyle}" Margin="0,0,0,4">â€¢ Mozilla Firefox</TextBlock>
                                </StackPanel>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Style="{StaticResource BodyTextStyle}" Margin="0,0,0,4">â€¢ Brave Browser</TextBlock>
                                    <TextBlock Style="{StaticResource BodyTextStyle}" Margin="0,0,0,4">â€¢ Opera</TextBlock>
                                    <TextBlock Style="{StaticResource BodyTextStyle}" Margin="0,0,0,4">â€¢ Opera GX</TextBlock>
                                </StackPanel>
                            </Grid>
                            <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Foreground="#5D5D5D">
                                Each browser's profiles are automatically detected from their configuration files.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Profile Auto-Detection -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="ProfileDetectionExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#E3F2FD" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="ðŸ‘¤" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Profile Auto-Detection" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="How browser profiles are discovered" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=ProfileDetectionExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=ProfileDetectionExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                LinkRouter reads each browser's configuration files to discover all available profiles:
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">
                                <Run FontWeight="SemiBold">Chrome/Edge/Brave:</Run> Reads the Local State JSON file to extract profile names and paths
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">
                                <Run FontWeight="SemiBold">Firefox:</Run> Parses profiles.ini to discover Firefox profiles
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">
                                <Run FontWeight="SemiBold">Opera:</Run> Detects the default Opera profile
                            </TextBlock>
                            <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Foreground="#5D5D5D" Margin="0,8,0,0">
                                Profiles are refreshed each time you open the browser picker or settings.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Default Browser Selection -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="DefaultBrowserSelectionExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#FFF3E0" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="â­" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Default Browser Selection" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="Fallback browser for unmatched URLs" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=DefaultBrowserSelectionExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=DefaultBrowserSelectionExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                The default browser is used when a URL doesn't match any rules or groups. Configure it from the Home page:
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">1. Go to Home in Settings</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">2. Select your preferred browser from the dropdown</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">3. Select a profile for that browser</TextBlock>
                            <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Foreground="#5D5D5D" Margin="0,8,0,0">
                                When no default is set, the browser picker will appear for unmatched URLs.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- MULTI-PROFILE RULES Section -->
            <TextBlock Text="Multi-Profile Rules"
                       Style="{StaticResource SectionHeaderStyle}"/>

            <!-- Adding Multiple Profiles -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="MultiProfileExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#F3E5F5" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="âž•" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Adding Multiple Profiles" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="Configure multiple browser/profile options for a rule" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=MultiProfileExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=MultiProfileExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                Rules and URL groups can have multiple browser/profile combinations. This is useful when you want to choose between different profiles at runtime.
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                <Run FontWeight="SemiBold">To add multiple profiles:</Run>
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">1. Edit an existing rule or create a new one</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">2. Click "Add Profile" to add another browser/profile combination</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">3. Repeat for as many profiles as needed</TextBlock>
                            <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Foreground="#5D5D5D" Margin="0,8,0,0">
                                Example: Add both "Work" and "Personal" Chrome profiles to your company's URL rule.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Profile Picker Behavior -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="ProfilePickerExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#E0F7FA" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="ðŸŽ¯" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Profile Picker Behavior" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="What happens when a rule has multiple profiles" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=ProfilePickerExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=ProfilePickerExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                <Run FontWeight="SemiBold">Single profile:</Run> The URL opens automatically in that browser/profile (auto-open).
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                <Run FontWeight="SemiBold">Multiple profiles:</Run> A compact profile picker dialog appears, showing only the profiles configured for that rule.
                            </TextBlock>
                            <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Foreground="#5D5D5D">
                                The picker shows custom display names if configured, making it easy to identify the right profile.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Custom Display Names -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="DisplayNamesExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#FFECB3" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="âœï¸" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Custom Display Names" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="Rename profiles within specific rules" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=DisplayNamesExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=DisplayNamesExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                You can set custom display names for profiles within a rule. These names are scoped to that specific rule and don't affect other rules.
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                <Run FontWeight="SemiBold">Example:</Run> Name a profile "Client Portal" for client URLs and "Internal Tools" for the same profile in a different rule.
                            </TextBlock>
                            <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Foreground="#5D5D5D">
                                This helps provide context-specific labels in the profile picker dialog.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- URL GROUPS (Expanded) Section -->
            <TextBlock Text="URL Groups (Advanced)"
                       Style="{StaticResource SectionHeaderStyle}"/>

            <!-- Built-in Groups -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="BuiltInGroupsExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#E8EAF6" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="ðŸ“¦" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Built-in URL Groups" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="Pre-configured groups for common services" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=BuiltInGroupsExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=BuiltInGroupsExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                LinkRouter includes pre-configured URL groups for popular services:
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">
                                <Run FontWeight="SemiBold">Microsoft 365:</Run> Outlook, Teams, SharePoint, OneDrive, Office apps
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">
                                <Run FontWeight="SemiBold">Google Suite:</Run> Gmail, Google Drive, Google Docs, Calendar, Meet
                            </TextBlock>
                            <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Foreground="#5D5D5D" Margin="0,8,0,0">
                                Built-in groups are disabled by default. Enable them and assign a browser/profile to activate.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- URL Overrides within Groups -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="GroupOverridesExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#FCE4EC" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="ðŸ”€" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="URL Overrides within Groups" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="Exceptions for specific URLs in a group" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=GroupOverridesExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=GroupOverridesExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                Within a URL group, you can set specific URL patterns to open in a different browser/profile than the group default.
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                <Run FontWeight="SemiBold">Example:</Run> In your "Microsoft 365" group, set teams.microsoft.com to open in Edge while other M365 URLs open in Chrome.
                            </TextBlock>
                            <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Foreground="#5D5D5D">
                                URL overrides have the highest priority in the matching order.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Moving Rules to Groups -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="MoveToGroupExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#FFF3E0" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="ðŸ“¤" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Moving Rules to Groups" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="Organize individual rules into groups" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=MoveToGroupExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=MoveToGroupExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                You can migrate individual URL rules into a URL group for better organization:
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">1. Go to Manage Rules</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">2. Find the rule you want to move</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">3. Click the Move icon (arrow) on the rule</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">4. Select the target group from the dialog</TextBlock>
                            <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Foreground="#5D5D5D" Margin="0,8,0,0">
                                The rule's URL pattern will be added to the group and the individual rule will be removed.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- QUICK ACTIONS Section -->
            <TextBlock Text="Quick Actions"
                       Style="{StaticResource SectionHeaderStyle}"/>

            <!-- On-the-Fly Rule Creation -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="QuickRuleExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#E8F5E9" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="âš¡" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="On-the-Fly Rule Creation" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="Create rules while opening URLs" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=QuickRuleExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=QuickRuleExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                When the browser picker appears for an unmatched URL, you can create a rule immediately:
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">1. Select a browser and profile</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">2. Check "Save as rule for this URL"</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">3. Click Open</TextBlock>
                            <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Foreground="#5D5D5D" Margin="0,8,0,0">
                                A rule will be created for that URL's domain, so future visits open automatically.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Enable/Disable Rules -->
            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="ToggleRulesExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#E3F2FD" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="ðŸ”˜" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Enable/Disable Rules" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="Toggle rules without deleting them" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=ToggleRulesExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=ToggleRulesExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                Each rule and URL group has a toggle switch to enable or disable it:
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">
                                <Run FontWeight="SemiBold">Enabled:</Run> The rule is active and will match URLs
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">
                                <Run FontWeight="SemiBold">Disabled:</Run> The rule is ignored during URL matching
                            </TextBlock>
                            <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap" Foreground="#5D5D5D" Margin="0,8,0,0">
                                This is useful for temporarily disabling rules without losing their configuration.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- TESTING & VALIDATION Section -->
            <TextBlock Text="Testing &amp; Validation"
                       Style="{StaticResource SectionHeaderStyle}"/>

            <Border Style="{StaticResource SettingsCardStyle}">
                <StackPanel>
                    <ToggleButton x:Name="TestingExpander" Background="Transparent" BorderThickness="0" Cursor="Hand" HorizontalContentAlignment="Stretch">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Width="36" Height="36" Background="#F3E5F5" CornerRadius="4" Margin="0,0,16,0">
                                <TextBlock Text="ðŸ§ª" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Test All Rules" Style="{StaticResource BodyStrongTextStyle}"/>
                                <TextBlock Text="Verify your rules are working correctly" Style="{StaticResource CaptionTextStyle}" Margin="0,2,0,0"/>
                            </StackPanel>
                            <Path Grid.Column="2" Data="{StaticResource ChevronDownIcon}" Stroke="#8A8A8A" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Path.Style>
                                    <Style TargetType="Path">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsChecked, ElementName=TestingExpander}" Value="True">
                                                <Setter Property="RenderTransform">
                                                    <Setter.Value>
                                                        <RotateTransform Angle="180"/>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Path.Style>
                            </Path>
                        </Grid>
                    </ToggleButton>
                    <Border Background="#F9F9F9" CornerRadius="4" Padding="16" Margin="52,12,0,0" Visibility="{Binding IsChecked, ElementName=TestingExpander, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,0,0,8">
                                LinkRouter includes an automated test runner to validate your configuration:
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">1. Go to Home in Settings</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">2. Click "Test All Rules"</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">3. View results showing passed/failed tests</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,12,0,8">
                                <Run FontWeight="SemiBold">Tests verify:</Run>
                            </TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">â€¢ URL pattern matching accuracy</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">â€¢ Priority order (group overrides > groups > rules > default)</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">â€¢ Profile group functionality</TextBlock>
                            <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="8,0,0,4">â€¢ Wildcard matching</TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- DATA & STORAGE Section -->
            <TextBlock Text="Data &amp; Storage"
                       Style="{StaticResource SectionHeaderStyle}"/>

            <Border Style="{StaticResource SettingsCardStyle}" Padding="20">
                <StackPanel>
                    <TextBlock Text="LinkRouter stores all configuration in your user profile:"
                               Style="{StaticResource BodyTextStyle}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16"/>

                    <Border Background="#F3F3F3" CornerRadius="4" Padding="16" Margin="0,0,0,12">
                        <StackPanel>
                            <TextBlock Text="%APPDATA%\BrowserSelector\" FontFamily="Consolas" FontWeight="SemiBold" Style="{StaticResource BodyTextStyle}" Margin="0,0,0,12"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="160"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="6"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="6"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="6"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="settings.json" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="Default browser, registration status" Style="{StaticResource CaptionTextStyle}"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="rules.json" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="Individual URL rules" Style="{StaticResource CaptionTextStyle}"/>

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="urlgroups.json" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                                <TextBlock Grid.Row="4" Grid.Column="1" Text="URL groups and their patterns" Style="{StaticResource CaptionTextStyle}"/>

                                <TextBlock Grid.Row="6" Grid.Column="0" Text="profilegroups.json" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                                <TextBlock Grid.Row="6" Grid.Column="1" Text="Profile group definitions" Style="{StaticResource CaptionTextStyle}"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <TextBlock Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap">
                        <Run FontWeight="SemiBold">Tip:</Run> Back up these files to preserve your configuration when reinstalling.
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- COMMAND LINE Section -->
            <TextBlock Text="Command Line"
                       Style="{StaticResource SectionHeaderStyle}"/>

            <Border Style="{StaticResource SettingsCardStyle}" Padding="20">
                <StackPanel>
                    <TextBlock Text="LinkRouter can be controlled via command line arguments:"
                               Style="{StaticResource BodyTextStyle}"
                               TextWrapping="Wrap"
                               Margin="0,0,0,16"/>

                    <Border Background="#F3F3F3" CornerRadius="4" Padding="16">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="180"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="8"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="8"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="8"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="8"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Argument" FontWeight="SemiBold" Style="{StaticResource CaptionStrongTextStyle}"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="Description" FontWeight="SemiBold" Style="{StaticResource CaptionStrongTextStyle}"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="--startup" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="Launch silently (for startup)" Style="{StaticResource CaptionTextStyle}"/>

                            <TextBlock Grid.Row="4" Grid.Column="0" Text="--manage" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                            <TextBlock Grid.Row="4" Grid.Column="1" Text="Open the Settings window" Style="{StaticResource CaptionTextStyle}"/>

                            <TextBlock Grid.Row="6" Grid.Column="0" Text="--register" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                            <TextBlock Grid.Row="6" Grid.Column="1" Text="Register as default browser handler" Style="{StaticResource CaptionTextStyle}"/>

                            <TextBlock Grid.Row="8" Grid.Column="0" Text="--unregister" FontFamily="Consolas" Style="{StaticResource BodyTextStyle}"/>
                            <TextBlock Grid.Row="8" Grid.Column="1" Text="Unregister from Windows" Style="{StaticResource CaptionTextStyle}"/>
                        </Grid>
                    </Border>

                    <TextBlock Style="{StaticResource BodyTextStyle}" TextWrapping="Wrap" Margin="0,16,0,0">
                        <Run FontWeight="SemiBold">Opening URLs:</Run> Pass any URL as an argument to route it through LinkRouter:
                    </TextBlock>
                    <Border Background="#F3F3F3" CornerRadius="4" Padding="12" Margin="0,8,0,0">
                        <TextBlock Text="LinkRouter.exe https://github.com" FontFamily="Consolas" Style="{StaticResource CaptionTextStyle}"/>
                    </Border>
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>
</UserControl>
